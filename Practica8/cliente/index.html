<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <title>Practica 8</title>
</head>
<body>
    <br>
    <div class="container">
        <h2>Ingrese un estudiante</h2>
        
        <div class="mb-3">
            <label for="name" class="form-label">Nombre</label>
            <input type="text" class="form-control" id="name">
        </div>
        <div class="mb-3">
            <label for="carnet" class="form-label">Carnet</label>
            <input type="text" class="form-control" id="carnet">
        </div>
            <button type="submit" class="btn btn-primary" onClick="create()">Enviar</button>
        </div>
    </div>
    <br>
    <div class="container">
        <h2>Lista de estudiantes</h2>

        <button type="submit" class="btn btn-primary" onClick="list()">Listar</button>
    </div>

    <script type="text/javascript">
        async function list() {
            const url = "http://localhost:8000/api/practica8";
            const option = {
                method: 'GET',
                headers: {'Accept': 'application/json', 'Content-Type' : 'application/json'}
            }

            let res = null;

            await fetch(url, option)
                .then((res) => {
                    return res.json();
                })
                .then((data) => {
                    res = data;
                })
                .catch((ex) => {
                    console.log(ex);
                    res = null;
                });
            
            if (res == null) {
                alert("error");
            }
            else {
                console.log(res);
            }
        }

        async function create() {
            let user = document.getElementById("name").value;
            let carnet = document.getElementById("carnet").value;

            document.getElementById("name").value = ""
            document.getElementById("carnet").value = ""
            
            const url = "http://localhost:8000/api/practica8";
            const option = {
                method: 'POST',
                headers: {'Accept': 'application/json', 'Content-Type' : 'application/json'},
                body: JSON.stringify({ nombre: user, carnet: carnet })
            }

            let res = null;

            await fetch(url, option)
                .then((res) => {
                    return res.json();
                })
                .then((data) => {
                    res = data;
                })
                .catch((ex) => {
                    console.log(ex);
                    res = null;
                });
            
            if (res == null) {
                alert("error");
            }
            else {
                alert("ok");
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
</body>
</html>